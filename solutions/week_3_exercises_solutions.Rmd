---
title: "Week 3 Exercises Solutions"
author: "J.Blondeau"
date: "2024-09-05"
output: 
  html_document:
    code_folding: hide
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

All the following question use the sttst_all_sites.xlsx file in the /data directory.


Import libraries but don't show the output 'include=FALSE'
```{r results='hide', message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(here) ### this library helps you with filepaths
```

1. Import sttstj_all_sites and inspect the data set.  What is the data structure and the data type of each field?


```{r}
##this is a code chunk, anything inside the back tics is like being in the R console.

## Inspect data
data_location <- here("data/sttstj_all_sites.xlsx")
print(data_location)

##Inspect the excel sheets available
excel_sheets(data_location)
read_xlsx(data_location, sheet = "Metadata")

## Read in data
data <- read_xlsx(data_location ,sheet = "locations")
class(data)
glimpse(data)
```
***

2. How many samples are in the data set?   

```{r}
nrow(data)
count(data)
data %>% 
  tally()

```


3. How many unique habitat types are there?  What are the names of each habitat?

Notice how the answer is the same, but the output type is different

```{r}

hab_types <- unique(data$hab)
hab_types

hab_types_alt <- data %>% 
  distinct(hab)

hab_types_alt
```


4. How many sites are there in the "PVMT" habitat type?

```{r}
data %>% 
  count(hab)

data %>% 
  filter(hab == "PVMT") %>% 
  count(hab)
  
```


5. How many sites are there in the "PVMT" or "AGRF" habitat types?

```{r}
data %>% 
  filter(hab %in% c("PVMT","AGRF")) %>% 
  count(hab)

```


6. How many sites are there in all the habitat types EXCEPT "PVMT"?

```{r}
data %>% 
  filter(hab != "PVMT") %>% 
  count(hab)
```


7. Show the first 5 records (rows) of...
    - all sites sampled in "AGRF" or "SCR"
    - only show the "yr_site" and "hab" columns
    
```{r}
data %>% 
  filter(hab %in% c("AGRF", "SCR")) %>% 
  head()

data %>% 
  filter(hab %in% c("AGRF", "SCR")) %>% 
  select(yr_site, hab) %>% 
  head()
```

    
<!-- extra line break -->
<br>

8. What is the northern most site sampled in the "BDRK" habitat?

```{r}
data %>% 
  filter(hab == "BDRK") %>% 
  arrange(desc(lat))
```


9. What is the western most site sampled in either "AGRF" or "PTRF" habitat?

```{r}
data %>% 
  filter(hab == "AGRF" | hab == "PTRF") %>% 
  arrange(lon)
  
```


10. How many years were surveyed in the data set?

```{r}
data %>% distinct(year) %>% 
  tally()

data %>% select(year) %>% n_distinct()
```


11. What is the eastern most site sample in the "AGRF" habitat in 2004?

```{r}
data %>% 
  filter(year == 2004 & hab == "PVMT") %>% 
  arrange(desc(lon))
```




